\iffalse
Make send emails
Rewrite scripts with time values printed out and estimated time to finish
Use outputdir volatile/dir in batch farm scripts!
Reconfigure root to pkl scripts to generate:
run num  - event num - heli - beam q - particle di - px - py - pz
for all particles

 put the filtered experirimenta epg data set at
/volatile/clas12/sangbaek/epg/inb
/volatile/clas12/sangbaek/epg/outb
If one wants to further filter out these data set for pi0, use minimal/convertEPG at https://github.com/Sangbaek/convertingHipo


SIM DATA:
run filtering
convert to root

GEN DATA:
convert to root

GENERATOR:
location:
tools/aao_gen
USAGE:
write in farm usage here

DST COPIER:
work/tools/other-tools/dst_copier_from_gemc_output.py
USAGE: go into the python script and manually change the input and output locations, then run it.

FILTER:
location:
work/tools/fiducial-filtering/filterEvents/bin/filterEvents
USAGE: ./bin/filterEvents -p "polarity" -s start -e end -t /path/to/hipo/files

CONVERTER:
location:
/tools/convert-hipo-to-root/convertingHipo/all/convertRec

PATH TO RESULTS:

copy all files from raw OSG output to a centralized location

monitor batch jobs: https://scicomp.jlab.org/scicomp/index.html#/farmJobs/activeJob

CONVERSION:
https://github.com/Sangbaek/convertingHipo

\fi

\section{Running Simulations}

\section{Processing GEMC Return into Pandas DF}

    \subsection{Move OSG Output to Volatile}
        This runs at about 5 Hz, so transfering 10K output files will take 2K seconds. In principle the code should be altered so this can be skipped if we want to save time.

        \begin{lstlisting}
            cd /work/clas12/robertej/tools
            python other-tools/dst_copier_from_gemc_output.py -d /volatile/clas12/osg2/robertej/job_2814/output/ -o /volatile/clas12/robertej/lowerxbq2t_gemc_output/   
        \end{lstlisting}
        
    
    \subsection{Move OSG Output to Volatile}
        This runs at about 5 Hz, so transfering 10K output files will take 2K seconds. In principle the code should be altered so this can be skipped if we want to save time.

            \begin{lstlisting}
        // Hello.java
        import javax.swing.JApplet;
        import java.awt.Graphics;
        
        public class Hello extends JApplet {
            public void paintComponent(Graphics g) {
                g.drawString("Hello, world!", 65, 95);
            }    
        }
        \end{lstlisting}

\clearpage
    \subsection{Filter and Convert all DST files}

        \begin{lstlisting}[language=python,caption={Generate Test Submission Scripts}]
        /work/clas12/robertej/tools/pi0_gen_tools/src/jsubs/jsub_filter_convert_machine.py\
        --filter_exedir /work/clas12/robertej/tools/fiducial-filtering/filterEvents/\
        --convert_dir   /work/clas12/robertej/tools/convert-hipo-to-root/convertingHipo/minimal/\
        --hipo_dir /volatile/clas12/robertej/lowerxbq2t_gemc_output/  \
        --twophotons  \
        -n 2  \
        --track debug
        \end{lstlisting}
        
        \begin{lstlisting}[language=python,caption={Submit Test Submission Scripts}]
        /work/clas12/robertej/tools/pi0_gen_tools/run/submit_jsubs.exe \
        --jobsdir sub_filt_con_warehouse/
        \end{lstlisting}
        
        \begin{lstlisting}[language=python,caption={Generate All Submission Scripts}]
        /work/clas12/robertej/tools/pi0_gen_tools/src/jsubs/jsub_filter_convert_machine.py\ 
         --filter_exedir /work/clas12/robertej/tools/fiducial-filtering/filterEvents/\
         --convert_dir   /work/clas12/robertej/tools/convert-hipo-to-root/convertingHipo/minimal/\
         --hipo_dir /volatile/clas12/robertej/lowerxbq2t_gemc_output/\
         --twophotons  
        \end{lstlisting}
        
        \begin{lstlisting}[language=bash,caption={Submit All Submission Scripts}]
        /work/clas12/robertej/tools/pi0_gen_tools/run/submit_jsubs.exe \
        --jobsdir sub_filt_con_warehouse/
        \end{lstlisting}
        
        This only submits jobs at a rate of about 0.5 Hz, so 10K files will take 6 hours to process. There should be a mechanism to speed this up greatly. If anyone knows it, let me know. 


    \subsection{Combine all Root Files}
    \begin{lstlisting}[language=bash,caption={Root combiner}]
        python3.6 /work/clas12/robertej/tools/root_combiner.py -d tests/
        \end{lstlisting}
     


    \subsection{Move combined root file to local drives}
        Go into Globus and scheduele file transfer
        INSERT PICTURE
        
        Then move to a semipermanent local storage directory e.g. D drive
        
     \subsection{Convert root to pandas with all combinations and execute DVPiP cuts}
     
      \subsection{Move onto analysis part 3}
      
      
     \section{Convert Generated Events}
     /work/clas12/robertej/tools/pi0_gen_tools/src/jsubs/jsub_convert_machine.py --convert_dir /work/clas12/robertej/tools/convert-hipo-to-root/convertingHipo/minimal/ --hipo_dir /volatile/clas12/robertej/lowerxbq2t_gemc_output/ --twophotons -n 2 --track debug --return_dir /volatile/clas12/robertej/lowerxbq2t_mcgen/
     
     
     Once copied to local, convert ROOT to Pandas DF:
     python convert_root_to_pickle/convert_RECON_root_to_pkl.py -f /mnt/d/CLAS12_2/merged_7999_files.root                  
        